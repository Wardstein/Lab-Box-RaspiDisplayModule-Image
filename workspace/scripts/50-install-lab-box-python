set -x
set -e

export LC_ALL=C

source /common.sh
install_cleanup_trap

# Scripts run as root by default


# Clone Lab-Box Python GUI git repo in home folder
cd /home/$RASPI_USER
git clone --depth 1 --branch $LABBOX-PYTHON-GUI-BRANCH https://github.com/Wardstein/Lab-Box-Python-GUI.git
cd Lab-Box-Python-GUI
chmod +x startRasPiDisplayModule.sh


# Setup autostart
$AUTOSTART_FILE="/etc/xdg/autostart/lab-box-gui.desktop"
cat <<EOF > $AUTOSTART_FILE
[Desktop Entry]
Type=Application
Name=Lab-Box GUI
Comment=Lab-Box GUI
NoDisplay=false
Exec=/usr/bin/lxterminal -e /home/$RASPI_USER/Lab-Box-Python-GUI/startRasPiDisplayModule.sh
NotShowIn=GNOME;KDE;XFCE;
EOF
